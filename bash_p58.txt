El shell Bash

MacProgramadores

La opción -n dice a sort que ordene numéricamente (no alfabéticamente) y
la opción -r dice a sort que saque los elementos ordenados de mayor a
menor. head recibe como argumento el número de líneas a mostrar, por
ejemplo head -2 significa coger las primeras 2 líneas.
Este script aunque funciona es un poco críptico, y vamos a hacer unos
cambios con vistas a mejorar su legibilidad. Por un lado vamos a poner
comentarios (precedidos por #) al principio del fichero, y vamos a usar
variables temporales para mejorar la legibilidad del programa. El resultado se
muestra en el Listado 4.8.
# Script que saca los mejores clientes
# Tiene la forma:
#
mejoresclientes <fichero> [<cuantos>]
fichero=$1
cuantos=$2
defecto=5
sort -nr $fichero | head -${cuantos:-$defecto}
Listado 4.8: Script que lista los mejores clientes

Estos cambios que hemos hecho mejoran la legibilidad del script, pero no su
tolerancia a errores, ya que si por ejemplo no pasamos el argumento $1, con
el nombre del fichero, se ejecutará el script así:
sort -nr | head -$5
Y sort se quedará esperando a que entren datos por su entrada estándar
hasta que el usuario pulse Ctrl+D o Ctrl+C. Esto se debe a que, aunque
controlamos que el segundo argumento no sea nulo, no controlamos el
primero.
En este caso podemos usar el operador de cadena :? para dar un mensaje
de error cambiando:
fichero=$1
Por:
fichero=${1:?'no suministrado'}
Ahora, si no suministrados el argumento se produce el mensaje:
./mejoresclientes: 1: no suministrado
Podemos mejorar la legibilidad de este mensaje si hacemos:
Pág 58

