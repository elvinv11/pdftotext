El shell Bash

MacProgramadores

Usando estos operadores vamos a mejorar la función ira() del Ejercicio 4.5
del Tema 4 para que antes de entrar en un directorio compruebe que el
directorio existe y que tenemos el permiso de listado (permiso x) del
directorio. Además comprobaremos que el argumento que se nos ha pasado
no sea el directorio donde ya estamos $PWD, para evitar meter dos veces
seguidas el mismo valor en la pila. Según esto la función quedaría así:
function ira
{
if [ -z "$1" ]; then
echo "Use ira <directorio>"
return 1
fi
if [ "$1" -ef "$PWD" ]; then
echo "Ya esta en el directorio $PWD"
return 2
fi
if [ \( -d "$1" \) -a \( -x "$1" \) ]; then
cd $1
PILADIR="$1 ${PILADIR:-$OLDPWD}"
echo $PILADIR
else
echo "Directorio $1 no valido"
fi
}
Obsérvese que la comparación del directorio a donde cambia $1 con el $PWD
la hemos hecho con -ef, y no con =, ya que de esta forma al ejecutar:
$ ira .
Ya esta en el directorio /Users/fernando
Estamos comparando . con $PWD, los cuales no son iguales desde el punto
de vista de = pero sí lo son desde el punto de vista de -ef.
Para comprobar que $1 sea un directorio válido hemos usado los operadores
-d y -x que comprueban respectivamente que sea un directorio, y que
tengamos permiso de cambiar a él.

Pág 78

