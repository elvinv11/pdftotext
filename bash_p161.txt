El shell Bash

MacProgramadores

" linea $_lineaactual"
_cmdprompt
elif (( $_steps==0 )); then
_msg "Parado en linea $_lineaactual"
_cmdprompt
fi
}
# Imprime los argumentos
function _msg
{
echo -e "$@" >&2
}
Listado 9.4: Implementación de _steptrap()

Cada vez que se ejecuta está función se decrementa _steps (el número de
pasos a dar antes de parar) siempre que _steps sea mayor o igual a 0. Al
llegar a 0 es cuando debemos parar.
La función comprueba si se cumple un breakpoint (por línea, o por condición),
en cuyo caso para mostrando el prompt, y también para si se cumple que
_steps vale 0. Si no se cumplen estas condiciones la función retorna y se
ejecuta la siguiente línea.

3.4.2.

El menú de comandos

Cada vez que se ejecuta la función _cmdprompt() se imprime un prompt,
en la salida de errores estándar, y se ejecutan los comandos introducidos por
el usuario hasta que esté abandona (opción q (quit)), pida ejecutar sin traza
(opción g (go)) la cual ejecuta hasta encontrar un breakpoint o acabar el
programa, o hace stepping (opción s (step)). La Tabla 9.3 muestra un
resumen de los comandos del menú (que imprime _menu() cuando
introducimos en el prompt el comando h u ?).
Comando
bp N
bp
bc condición
bc
cb N
cb
p
g
s [N]
x

Acción
Pone un breakpoint en la línea N
Lista los breakpoints
Para cuando se cumple la condición condición
Borra el breakpoint condicional
Borra el breakpoint en la línea N
Borra todos los breakpoints
Muestra el texto del script original junto con los breakpoint
y la posición actual
Empieza/continua con la ejecución (Go)
Ejecuta N pasos (por defecto 1 paso)
Activa/desactiva la traza
Pág 161

