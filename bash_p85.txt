El shell Bash

MacProgramadores

5. La sentencia select
La sentencia select nos permite generar fácilmente un menú simple. Su
sintaxis es la siguiente:
select variable [in lista]
do
Sentencias que usan $variable
done
Vemos que tiene la misma sintaxis que el bucle for, excepto por la keyword
select en vez de for. De hecho si omitimos in lista también se usa por
defecto $@.
La sentencia genera un menú con los elementos de lista, donde asigna un
número a cada elemento, y pide al usuario que introduzca un número. El
valor elegido se almacena en variable, y el número elegido en la variable
REPLY. Una vez elegida una opción por parte del usuario, se ejecuta el
cuerpo de la sentencia y el proceso se repite en un bucle infinito.
Aunque el bucle de select es infinito (lo cual nos permite volver a pedir una
opción cuantas veces haga falta), el bucle se puede abandonar usando la
sentencia break. La sentencia break, al igual que en C y Java, se usa para
abandonar un bucle, y se puede usar en el caso, tanto de select, como de
los bucles for, while y until. Pero a diferencia de C y Java no sirve para
abandonar la sentencia case, sino que ésta se abandona usando los dos
puntos comas ;;.
El prompt que usa la función es el definido en la variable de entorno PS3, y
es habitual cambiar este prompt antes de ejecutar select para que muestre
al usuario un mensaje más descriptivo. Por defecto el valor de PS3 es #?, lo
cual no es un prompt que suela gustar especialmente a los usuarios.
Ejercicio 5.6
Escribir una función llamada elegirdir() que permita al usuario elegir un
directorio de los disponibles en la variable de entorno PILADIR (del Ejercicio
4.5). El directorio elegido se mueve al principio de la pila PILADIR y se
convierte en el directorio actual.
El Listado 5.7 muestra la solución propuesta. La función cambia el prompt
PS3 antes de ejecutar select. El cuerpo de select se ejecutará tantas
veces haga falta, hasta que se elija una opción válida ($dir no sea nula). El
resto de funcionalidad ya debería ser conocida por el lector.

Pág 85

