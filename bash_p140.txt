El shell Bash

MacProgramadores

el script puede pararlo con Ctrl+Z y luego hacerle un kill (que envía la
SIGTERM no la SIGINT):
^Z
[1]+ Stopped
$ kill %1
[1]+ Terminated

capturasenal
capturasenal

Podemos ahora añadir la captura de la señal SIGTERM como muestra el
Listado 8.2.
trap "echo 'Pulsaste Ctrl+C!'" INT
trap "echo 'Intentaste terminarme!'" TERM
while true
do
sleep 60;
echo "Cambio de minuto"
done
Listado 8.2: Script que captura la SIGINT y la SIGTERM

Si ahora ejecutamos el script en background:
$ capturasenal &
[1] 1504
E intentamos terminarlo:
$ jobs
[1]+ Running
$ kill %1
Intentaste terminarme!
Cambio de minuto

capturasenal &

El script se defiende. Siempre podemos terminarlo enviándole la SIGKILL
que sabemos que no la puede capturar:
$ kill -KILL %1
[1]+ Killed

capturasenal

4.2. Traps y funciones
Como sabemos, las funciones se ejecutan
que las llama, en consecuencia dentro de
trap fijado por el script, y viceversa, un
activo cuando ésta termina. Por ejemplo,

Pág 140

en el mismo proceso que el script
una función se puede detectar un
trap fijado por una función sigue
en el Listado 8.3 se muestra una

