El shell Bash

MacProgramadores

El Listado 7.2 muestra la operación contraría, ahora pretendemos enviar
todas las salidas estándar de un conjunto de comandos a un fichero.
Obsérvese que el comando sólo captura las salidas estándar de los comandos,
para capturar también las salidas de error estándar deberíamos de haber
redirigido stderr (p.e. usando &>fichero).
LOGFILE=logfile.txt
exec 6>&1

# Salva stdout

exec > $LOGFILE

# Reemplaza stdout por
# el fichero logfile.log
# Todas las salidas van a logfile.log
····························
····························
····························
exec 1>&6 6>&# Retaura stdout y cierra el fichero
Listado 7.2: Script que captura las salidas estándar

1.3. Here documents
El operador <<etiqueta fuerza a que la entrada a un comando sea la stdin
hasta encontrar etiqueta. Este texto que va hasta encontrar etiqueta es
lo que se llama here document.
Por ejemplo podemos hacer que cat recoja texto hasta que encuentre una
línea con un sólo punto, y guarde este texto en el fichero mensaje.txt así:
$
>
>
>
>

cat >> mensaje.txt << .
Hola.
Esto es un mensaje de correo
Adios.
.

El recoger texto de stdin y mandarlo a un comando es lo que ya se hace por
defecto, con lo que en principio este operador no sería muy útil, excepto por
detectar el final del documento. Pero los here document muchas veces se
utilizan para dar la entrada a un comando que no queremos que escriba el
usuario, sino que escribimos nosotros mismos dentro de un script. Por
ejemplo, el script del Listado 7.3 sube un fichero a un servidor FTP usando el
comando ftp. El script recibe cinco argumentos, el fichero a subir, el servidor
FTP a donde subirlo, el usuario, el password, y la ruta del servidor FTP donde
depositarlo. Obsérvese que el here document puede tener variables que se
expanden por su valor antes de ser pasadas a la entrada estándar del
comando.

Pág 112

